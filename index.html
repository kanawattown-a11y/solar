<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المنظومة الشمسية ثلاثية الأبعاد</title>
    <style>
        body { margin: 0; background-color: #000; }
        canvas { display: block; }
        .label {
            color: #fff;
            font-family: sans-serif;
            padding: 2px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.164.1/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.164.1/examples/jsm/"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        // إعداد المشهد، الكاميرا، والعارض
        const scene = new THREE.Scene( );
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // عارض التسميات
        const labelRenderer = new CSS2DRenderer();
        labelRenderer.setSize(window.innerWidth, window.innerHeight);
        labelRenderer.domElement.style.position = 'absolute';
        labelRenderer.domElement.style.top = '0px';
        document.body.appendChild(labelRenderer.domElement);

        // أدوات التحكم بالمدار
        const controls = new OrbitControls(camera, labelRenderer.domElement);
        controls.enableDamping = true;

        // تحميل صورة الخلفية (النجوم)
        const textureLoader = new THREE.TextureLoader();
        const starTexture = textureLoader.load('./8k_stars_milky_way.jpg' );
        scene.background = starTexture;

        // إنشاء الشمس
        const sunGeometry = new THREE.SphereGeometry(16, 30, 30);
        const sunTexture = textureLoader.load('./8k_sun.jpg' );
        const sunMaterial = new THREE.MeshBasicMaterial({ map: sunTexture });
        const sun = new THREE.Mesh(sunGeometry, sunMaterial);
        scene.add(sun);

        // إضافة ضوء نقطي من الشمس
        const pointLight = new THREE.PointLight(0xffffff, 3, 300);
        scene.add(pointLight);

        // إضافة ضوء محيطي خافت
        const ambientLight = new THREE.AmbientLight(0x333333);
        scene.add(ambientLight);

        // دالة لإنشاء الكواكب
        function createPlanet(size, textureUrl, position, ring) {
            const geometry = new THREE.SphereGeometry(size, 30, 30);
            const texture = textureLoader.load(textureUrl);
            const material = new THREE.MeshStandardMaterial({ map: texture });
            const planet = new THREE.Mesh(geometry, material);
            
            const obj = new THREE.Object3D();
            obj.add(planet);
            
            if (ring) {
                const ringGeo = new THREE.RingGeometry(ring.innerRadius, ring.outerRadius, 32);
                const ringTexture = textureLoader.load(ring.textureUrl);
                const ringMat = new THREE.MeshBasicMaterial({
                    map: ringTexture,
                    side: THREE.DoubleSide,
                    transparent: true
                });
                const ringMesh = new THREE.Mesh(ringGeo, ringMat);
                obj.add(ringMesh);
                ringMesh.rotation.x = -0.5 * Math.PI;
            }

            planet.position.x = position;
            scene.add(obj);
            return { mesh: planet, obj: obj };
        }

        // إنشاء الكواكب
        const mercury = createPlanet(3.2, './8k_mercury.jpg', 28 );
        const venus = createPlanet(5.8, './8k_venus_surface.jpg', 44 );
        const earth = createPlanet(6, './8k_earth_daymap.jpg', 62 );
        const mars = createPlanet(4, './8k_mars.jpg', 78 );
        const jupiter = createPlanet(12, './8k_jupiter.jpg', 100 );
        const saturn = createPlanet(10, './8k_saturn.jpg', 138, {
            innerRadius: 10,
            outerRadius: 20,
            textureUrl: './8k_saturn_ring_alpha.png'
        } );
        const uranus = createPlanet(7, './2k_uranus.jpg', 176, {
            innerRadius: 7,
            outerRadius: 12,
            textureUrl: './2k_uranus_ring_alpha.png'
        } );
        const neptune = createPlanet(7, './2k_neptune.jpg', 200 );

        // إضافة تسميات للكواكب
        function addLabel(name, object) {
            const div = document.createElement('div');
            div.className = 'label';
            div.textContent = name;
            const label = new CSS2DObject(div);
            label.position.set(0, object.geometry.parameters.radius + 2, 0);
            object.add(label);
        }

        addLabel('عطارد', mercury.mesh);
        addLabel('الزهرة', venus.mesh);
        addLabel('الأرض', earth.mesh);
        addLabel('المريخ', mars.mesh);
        addLabel('المشتري', jupiter.mesh);
        addLabel('زحل', saturn.mesh);
        addLabel('أورانوس', uranus.mesh);
        addLabel('نبتون', neptune.mesh);

        camera.position.z = 250;
        camera.position.y = 50;
        camera.lookAt(scene.position);

        // حلقة التحريك
        function animate() {
            requestAnimationFrame(animate);

            // دوران الكواكب حول نفسها
            sun.rotateY(0.004);
            mercury.mesh.rotateY(0.004);
            venus.mesh.rotateY(0.002);
            earth.mesh.rotateY(0.02);
            mars.mesh.rotateY(0.018);
            jupiter.mesh.rotateY(0.04);
            saturn.mesh.rotateY(0.038);
            uranus.mesh.rotateY(0.03);
            neptune.mesh.rotateY(0.032);

            // دوران الكواكب حول الشمس
            mercury.obj.rotateY(0.04);
            venus.obj.rotateY(0.015);
            earth.obj.rotateY(0.01);
            mars.obj.rotateY(0.008);
            jupiter.obj.rotateY(0.002);
            saturn.obj.rotateY(0.0009);
            uranus.obj.rotateY(0.0004);
            neptune.obj.rotateY(0.0001);

            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }

        animate();

        // تحديث حجم العرض عند تغيير حجم النافذة
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
